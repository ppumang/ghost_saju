import type { CheonGan, JiJi, OhHaeng, EumYang } from './types';

// 중국어 천간 → 한국어 변환
export const CN_GAN_TO_KR: Record<string, CheonGan> = {
  '甲': '갑', '乙': '을', '丙': '병', '丁': '정', '戊': '무',
  '己': '기', '庚': '경', '辛': '신', '壬': '임', '癸': '계',
};

// 중국어 지지 → 한국어 변환
export const CN_JI_TO_KR: Record<string, JiJi> = {
  '子': '자', '丑': '축', '寅': '인', '卯': '묘', '辰': '진', '巳': '사',
  '午': '오', '未': '미', '申': '신', '酉': '유', '戌': '술', '亥': '해',
};

// 천간 → 오행
export const GAN_TO_OHAENG: Record<CheonGan, OhHaeng> = {
  '갑': '목', '을': '목',
  '병': '화', '정': '화',
  '무': '토', '기': '토',
  '경': '금', '신': '금',
  '임': '수', '계': '수',
};

// 지지 → 오행
export const JI_TO_OHAENG: Record<JiJi, OhHaeng> = {
  '인': '목', '묘': '목',
  '사': '화', '오': '화',
  '진': '토', '술': '토', '축': '토', '미': '토',
  '신': '금', '유': '금',
  '해': '수', '자': '수',
};

// 천간 → 음양
export const GAN_TO_EUMYANG: Record<CheonGan, EumYang> = {
  '갑': '양', '을': '음',
  '병': '양', '정': '음',
  '무': '양', '기': '음',
  '경': '양', '신': '음',
  '임': '양', '계': '음',
};

// 지지 → 음양
export const JI_TO_EUMYANG: Record<JiJi, EumYang> = {
  '자': '양', '축': '음',
  '인': '양', '묘': '음',
  '진': '양', '사': '음',
  '오': '양', '미': '음',
  '신': '양', '유': '음',
  '술': '양', '해': '음',
};

// 십신 중국어 → 한국어
export const CN_SIPSHIN_TO_KR: Record<string, string> = {
  '比肩': '비견', '劫财': '겁재',
  '食神': '식신', '伤官': '상관',
  '偏财': '편재', '正财': '정재',
  '七杀': '편관', '正官': '정관',
  '偏印': '편인', '正印': '정인',
  // 일간 자신
  '日主': '일주',
};

// 십이운성 중국어 → 한국어
export const CN_DISHI_TO_KR: Record<string, string> = {
  '长生': '장생', '沐浴': '목욕', '冠带': '관대',
  '临官': '건록', '帝旺': '제왕',
  '衰': '쇠', '病': '병', '死': '사',
  '墓': '묘', '绝': '절', '胎': '태', '养': '양',
};

// 납음 중국어 → 한국어
export const CN_NAYIN_TO_KR: Record<string, string> = {
  '海中金': '해중금', '炉中火': '노중화', '大林木': '대림목',
  '路旁土': '노방토', '剑锋金': '검봉금', '山头火': '산두화',
  '涧下水': '간하수', '城头土': '성두토', '白蜡金': '백랍금',
  '杨柳木': '양류목', '泉中水': '천중수', '屋上土': '옥상토',
  '霹雳火': '벽력화', '松柏木': '송백목', '长流水': '장류수',
  '沙中金': '사중금', '山下火': '산하화', '平地木': '평지목',
  '壁上土': '벽상토', '金箔金': '금박금', '覆灯火': '복등화',
  '天河水': '천하수', '大驿土': '대역토', '钗钏金': '채천금',
  '桑柘木': '상자목', '大溪水': '대계수', '沙中土': '사중토',
  '天上火': '천상화', '石榴木': '석류목', '大海水': '대해수',
};

// 지지 → 띠
export const JI_TO_ZODIAC: Record<JiJi, string> = {
  '자': '쥐', '축': '소', '인': '호랑이', '묘': '토끼',
  '진': '용', '사': '뱀', '오': '말', '미': '양',
  '신': '원숭이', '유': '닭', '술': '개', '해': '돼지',
};

// 일간(日干) 특성 설명
export const DAY_MASTER_DESC: Record<CheonGan, string> = {
  '갑': '갑목(甲木) - 큰 나무, 곧은 성격, 리더십',
  '을': '을목(乙木) - 풀꽃, 유연한 적응력, 부드러움',
  '병': '병화(丙火) - 태양, 밝은 에너지, 열정',
  '정': '정화(丁火) - 촛불, 섬세한 빛, 따뜻함',
  '무': '무토(戊土) - 산, 듬직한 안정감, 포용력',
  '기': '기토(己土) - 농토, 기르는 힘, 실리적',
  '경': '경금(庚金) - 바위/칼, 강인함, 의리',
  '신': '신금(辛金) - 보석, 예리한 감각, 섬세함',
  '임': '임수(壬水) - 큰 강, 지혜로움, 포용력',
  '계': '계수(癸水) - 이슬/빗물, 감수성, 직관력',
};

// 도화살 테이블: 일지 기준으로 어떤 지지가 도화살인지
// 일지가 寅午戌이면 도화는 卯, 巳酉丑이면 도화는 午, etc.
export const DOHWA_TABLE: Record<JiJi, JiJi> = {
  '인': '묘', '오': '묘', '술': '묘',
  '사': '오', '유': '오', '축': '오',
  '신': '유', '자': '유', '진': '유',
  '해': '자', '묘': '자', '미': '자',
};

// 역마살 테이블: 일지 기준
export const YEOKMA_TABLE: Record<JiJi, JiJi> = {
  '인': '신', '오': '신', '술': '신',
  '사': '해', '유': '해', '축': '해',
  '신': '인', '자': '인', '진': '인',
  '해': '사', '묘': '사', '미': '사',
};

// 화개살 테이블: 일지 기준
export const HWAGAE_TABLE: Record<JiJi, JiJi> = {
  '인': '술', '오': '술', '술': '술',
  '사': '축', '유': '축', '축': '축',
  '신': '진', '자': '진', '진': '진',
  '해': '미', '묘': '미', '미': '미',
};

// ============================
// 확장 테이블 (v2)
// ============================

// 상생 사이클: A가 B를 생한다
export const PRODUCING: Record<OhHaeng, OhHaeng> = {
  '목': '화', '화': '토', '토': '금', '금': '수', '수': '목',
};

// 상극 사이클: A가 B를 극한다
export const CONTROLLING: Record<OhHaeng, OhHaeng> = {
  '목': '토', '화': '금', '토': '수', '금': '목', '수': '화',
};

// A를 생하는 오행
export const PRODUCED_BY: Record<OhHaeng, OhHaeng> = {
  '목': '수', '화': '목', '토': '화', '금': '토', '수': '금',
};

// A를 극하는 오행
export const CONTROLLED_BY: Record<OhHaeng, OhHaeng> = {
  '목': '금', '화': '수', '토': '목', '금': '화', '수': '토',
};

// 월지 → 계절 득령 오행 (어떤 오행이 왕성한 계절인지)
// 인/묘: 봄(목왕), 사/오: 여름(화왕), 신/유: 가을(금왕), 해/자: 겨울(수왕)
// 진/술/축/미: 환절기(토왕)
export const SEASONAL_STRENGTH: Record<JiJi, OhHaeng> = {
  '인': '목', '묘': '목',
  '사': '화', '오': '화',
  '신': '금', '유': '금',
  '해': '수', '자': '수',
  '진': '토', '술': '토', '축': '토', '미': '토',
};

// 십신 → 카테고리 (강약 판정용)
// 비겁/인성 = 일간을 돕는 세력, 나머지 = 일간을 약화시키는 세력
export const SIPSHIN_CATEGORY: Record<string, 'help' | 'drain'> = {
  '비견': 'help', '겁재': 'help',
  '편인': 'help', '정인': 'help',
  '식신': 'drain', '상관': 'drain',
  '편재': 'drain', '정재': 'drain',
  '편관': 'drain', '정관': 'drain',
  '일주': 'help', // 일간 자신
};

// 육해 쌍 (서로 해가 되는 지지)
export const YUKHAE_PAIRS: [JiJi, JiJi][] = [
  ['자', '미'], ['축', '오'], ['인', '사'],
  ['묘', '진'], ['신', '해'], ['유', '술'],
];

// 반안살 테이블: 일지 기준 → 반안 지지
export const BANAN_TABLE: Record<JiJi, JiJi> = {
  '자': '축', '축': '인', '인': '묘', '묘': '진',
  '진': '사', '사': '오', '오': '미', '미': '신',
  '신': '유', '유': '술', '술': '해', '해': '자',
};

// 현침살: 해당 지지가 있으면 현침살
export const HYEONCHIM_BRANCHES: JiJi[] = ['자', '오', '묘', '유'];

// 귀문관살 테이블: 일지 기준 → 귀문관 지지
export const GWIMUNGWAN_TABLE: Record<JiJi, JiJi> = {
  '자': '유', '축': '오', '인': '미', '묘': '신',
  '진': '사', '사': '진', '오': '축', '미': '인',
  '신': '묘', '유': '자', '술': '해', '해': '술',
};

// 지살 테이블: 년지 기준 → 지살 지지
export const JISAL_TABLE: Record<JiJi, JiJi> = {
  '인': '사', '오': '사', '술': '사',
  '사': '신', '유': '신', '축': '신',
  '신': '해', '자': '해', '진': '해',
  '해': '인', '묘': '인', '미': '인',
};

// 천을귀인: 일간 기준 → 천을귀인이 되는 지지들
export const CHEONUL_GUIIN: Record<CheonGan, JiJi[]> = {
  '갑': ['축', '미'], '을': ['자', '신'],
  '병': ['해', '유'], '정': ['해', '유'],
  '무': ['축', '미'], '기': ['자', '신'],
  '경': ['축', '미'], '신': ['인', '오'],
  '임': ['묘', '사'], '계': ['묘', '사'],
};

// 태극귀인: 일간 기준 → 태극귀인이 되는 지지들
export const TAEGEUK_GUIIN: Record<CheonGan, JiJi[]> = {
  '갑': ['자', '사'], '을': ['자', '사'],
  '병': ['축', '오'], '정': ['축', '오'],
  '무': ['축', '오'], '기': ['축', '오'],
  '경': ['인', '미'], '신': ['인', '미'],
  '임': ['묘', '신'], '계': ['묘', '신'],
};

// 월덕귀인: 월지 기준 → 월덕귀인이 되는 천간
// 삼합 그룹: 寅午戌→丙, 申子辰→壬, 亥卯未→甲, 巳酉丑→庚
export const WOLDEOK_GUIIN: Record<JiJi, CheonGan> = {
  '인': '병', '묘': '갑', '진': '임', '사': '경',
  '오': '병', '미': '갑', '신': '임', '유': '경',
  '술': '병', '해': '갑', '자': '임', '축': '경',
};

// 충 쌍 (서로 충하는 지지)
export const CHUNG_PAIRS: [JiJi, JiJi][] = [
  ['자', '오'], ['축', '미'], ['인', '신'],
  ['묘', '유'], ['진', '술'], ['사', '해'],
];

// 원진 쌍 (서로 원진인 지지)
export const WONJIN_PAIRS: [JiJi, JiJi][] = [
  ['자', '미'], ['축', '오'], ['인', '유'],
  ['묘', '신'], ['진', '해'], ['사', '술'],
];

// 천간합: 합이 되는 천간 쌍
export const CHUNGAN_HAP: [CheonGan, CheonGan, OhHaeng][] = [
  ['갑', '기', '토'],  // 갑기합토
  ['을', '경', '금'],  // 을경합금
  ['병', '신', '수'],  // 병신합수
  ['정', '임', '목'],  // 정임합목
  ['무', '계', '화'],  // 무계합화
];

// ============================
// Phase 1: 지지 관계 확장 테이블
// ============================

// 삼합 (三合): 3개 지지가 모이면 특정 오행을 이룸
// [지지1, 지지2, 지지3, 결과오행]
export const SAMHAP_GROUPS: [JiJi, JiJi, JiJi, OhHaeng][] = [
  ['인', '오', '술', '화'],  // 인오술 삼합화
  ['사', '유', '축', '금'],  // 사유축 삼합금
  ['신', '자', '진', '수'],  // 신자진 삼합수
  ['해', '묘', '미', '목'],  // 해묘미 삼합목
];

// 육합 (六合): 2개 지지가 합하여 특정 오행을 이룸
// [지지1, 지지2, 결과오행]
export const YUKHAP_PAIRS: [JiJi, JiJi, OhHaeng][] = [
  ['자', '축', '토'],  // 자축합토
  ['인', '해', '목'],  // 인해합목
  ['묘', '술', '화'],  // 묘술합화
  ['진', '유', '금'],  // 진유합금
  ['사', '신', '수'],  // 사신합수
  ['오', '미', '화'],  // 오미합화 (午未合火)
];

// 방합 (方合): 같은 방향의 3지지 → 해당 오행 강화
// [지지1, 지지2, 지지3, 결과오행]
export const BANGHAP_GROUPS: [JiJi, JiJi, JiJi, OhHaeng][] = [
  ['인', '묘', '진', '목'],  // 동방합목
  ['사', '오', '미', '화'],  // 남방합화
  ['신', '유', '술', '금'],  // 서방합금
  ['해', '자', '축', '수'],  // 북방합수
];

// 형 (刑): 4종류
// 무은지형 (無恩之刑): 은혜를 모르는 형
export const HYEONG_MUEUN: [JiJi, JiJi][] = [
  ['인', '사'], ['사', '신'], ['신', '인'],
];
// 지세지형 (恃勢之刑): 세력을 믿는 형
export const HYEONG_JISE: [JiJi, JiJi][] = [
  ['축', '술'], ['술', '미'], ['미', '축'],
];
// 무례지형 (無禮之刑): 예의 없는 형
export const HYEONG_MURYE: [JiJi, JiJi][] = [
  ['자', '묘'], ['묘', '자'],
];
// 자형 (自刑): 같은 지지끼리
export const HYEONG_JA: JiJi[] = ['진', '오', '유', '해'];

// 파 (破): 6쌍
export const PA_PAIRS: [JiJi, JiJi][] = [
  ['자', '유'], ['축', '진'], ['인', '해'],
  ['묘', '오'], ['사', '신'], ['미', '술'],
];

// ============================
// Phase 2B: 추가 신살 테이블 (8종)
// ============================

// 양인살 (羊刃殺): 양간(陽干) 기준 → 양인이 되는 지지
// 음간은 양인살 없음 (빈 배열)
export const YANGIN_TABLE: Record<CheonGan, JiJi | null> = {
  '갑': '묘', '을': null,
  '병': '오', '정': null,
  '무': '오', '기': null,
  '경': '유', '신': null,
  '임': '자', '계': null,
};

// 괴강살 (魁罡殺): 해당 일주(일간+일지)가 괴강
export const GOEGANG_ILJU: string[] = ['무진', '무술', '경진', '경술'];

// 백호살 (白虎殺): 일지 기준 → 백호가 되는 지지 (충 위치)
// NOTE: 현대 한국 사주 실무에서 통용되는 충 기반 테이블 사용.
// 고전(삼명통회) 삼합그룹 기반 해석과는 차이 있음.
export const BAEKHO_TABLE: Record<JiJi, JiJi> = {
  '자': '오', '축': '미', '인': '신', '묘': '유',
  '진': '술', '사': '해', '오': '자', '미': '축',
  '신': '인', '유': '묘', '술': '진', '해': '사',
};

// 겁살 (劫殺): 년지(삼합그룹 기준) → 겁살 지지
export const GEOBSAL_TABLE: Record<JiJi, JiJi> = {
  '인': '해', '오': '해', '술': '해',  // 인오술 → 해
  '사': '인', '유': '인', '축': '인',  // 사유축 → 인
  '신': '사', '자': '사', '진': '사',  // 신자진 → 사
  '해': '신', '묘': '신', '미': '신',  // 해묘미 → 신
};

// 천라지망 (天羅地網): 진+술 = 천라, 사+해 = 지망
// 분석 로직에서 4기둥 지지 중 진+술, 사+해 동시존재 체크

// 망신살 (亡身殺): 년지(삼합그룹 기준) → 망신 지지
export const MANGSHIN_TABLE: Record<JiJi, JiJi> = {
  '인': '신', '오': '신', '술': '신',  // 인오술 → 신
  '사': '해', '유': '해', '축': '해',  // 사유축 → 해
  '신': '인', '자': '인', '진': '인',  // 신자진 → 인
  '해': '사', '묘': '사', '미': '사',  // 해묘미 → 사
};

// 장성살 (將星殺): 년지(삼합그룹 기준) → 장성 지지
export const JANGSEONG_TABLE: Record<JiJi, JiJi> = {
  '인': '오', '오': '오', '술': '오',  // 인오술 → 오
  '사': '유', '유': '유', '축': '유',  // 사유축 → 유
  '신': '자', '자': '자', '진': '자',  // 신자진 → 자
  '해': '묘', '묘': '묘', '미': '묘',  // 해묘미 → 묘
};

// ============================
// Phase 2C: 추가 귀인 테이블 (5종)
// ============================

// 천덕귀인 (天德貴人): 월지 기준 → 천덕귀인이 되는 천간
export const CHEONDEOK_GUIIN: Record<JiJi, CheonGan> = {
  '인': '정', '묘': '신', '진': '임', '사': '신',
  '오': '기', '미': '계', '신': '갑', '유': '을',
  '술': '병', '해': '을', '자': '기', '축': '경',
};

// 문창귀인 (文昌貴人): 일간 기준 → 문창귀인이 되는 지지
export const MUNCHANG_GUIIN: Record<CheonGan, JiJi> = {
  '갑': '사', '을': '오', '병': '신', '정': '유',
  '무': '신', '기': '유', '경': '해', '신': '자',
  '임': '인', '계': '묘',
};

// 학당귀인 (學堂貴人): 일간 기준 → 학당귀인이 되는 지지
export const HAKDANG_GUIIN: Record<CheonGan, JiJi> = {
  '갑': '해', '을': '오', '병': '인', '정': '유',
  '무': '인', '기': '유', '경': '사', '신': '자',
  '임': '신', '계': '묘',
};

// 천관귀인 (天官貴人): 일간 기준 → 천관귀인이 되는 지지
export const CHEONGWAN_GUIIN: Record<CheonGan, JiJi> = {
  '갑': '미', '을': '진', '병': '사', '정': '인',
  '무': '사', '기': '인', '경': '술', '신': '미',
  '임': '해', '계': '오',
};

// 금여귀인 (金輿貴人): 일간 기준 → 금여귀인이 되는 지지
export const GEUMYEO_GUIIN: Record<CheonGan, JiJi> = {
  '갑': '진', '을': '사', '병': '미', '정': '신',
  '무': '미', '기': '신', '경': '술', '신': '해',
  '임': '축', '계': '인',
};

// 홍염살 (紅艶殺): 일간 기준 → 홍염살이 되는 지지
// 이성/매력/색정 관련 신살 (도화살과 함께 주요 이성 관련 신살)
export const HONGYEOM_TABLE: Record<CheonGan, JiJi> = {
  '갑': '오', '을': '신', '병': '인', '정': '미',
  '무': '진', '기': '진', '경': '술', '신': '유',
  '임': '자', '계': '신',
};

// 오행 컬러맵 (다크테마용)
export const OHAENG_COLORS: Record<OhHaeng, { bg: string; text: string }> = {
  '목': { bg: '#1a3d1a', text: '#6bcf6b' },
  '화': { bg: '#3d1a1a', text: '#cf6b6b' },
  '토': { bg: '#3d351a', text: '#cfb86b' },
  '금': { bg: '#2a2a2a', text: '#d0d0d0' },
  '수': { bg: '#1a1a3d', text: '#6b8fcf' },
};
